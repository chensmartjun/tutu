(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b4d502e"],{4831:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"stockA",staticStyle:{display:"flex","align-items":"center","justify-content":"space-between"}},[n("div",{staticClass:"stockB",staticStyle:{display:"flex","align-items":"center"}},[n("img",{class:null==t.prev?"gray":"",staticStyle:{width:"30px",transform:"rotate(180deg)"},attrs:{src:a("b887"),alt:""},on:{click:function(e){1!=t.isAdd&&1!=!t.isedit&&t.firstPage()}}}),n("img",{class:null==t.prev?"gray":"",staticStyle:{width:"30px",transform:"rotate(180deg)",margin:"0 15px"},attrs:{src:a("e484"),alt:""},on:{click:function(e){1!=t.isAdd&&1!=!t.isedit&&t.prevPage()}}}),n("img",{class:null==t.next?"gray":"",staticStyle:{width:"30px","margin-right":"15px"},attrs:{src:a("e484"),alt:""},on:{click:function(e){1!=t.isAdd&&1!=!t.isedit&&t.nextPage()}}}),n("img",{class:null==t.next?"gray":"",staticStyle:{width:"30px"},attrs:{src:a("b887"),alt:""},on:{click:function(e){1!=t.isAdd&&1!=!t.isedit&&t.lastPage()}}}),n("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"warning",icon:"el-icon-refresh",size:"mini"},on:{click:function(e){t.outData.isshow=!0}}},[t._v("筛选")]),n("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success",icon:"el-icon-download",size:"mini"},on:{click:t.showOut}},[t._v("导出")])],1),n("div",{staticStyle:{float:"right"}},[1==t.perData.allow_add?n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus",disabled:t.isAdd||!t.isedit},on:{click:t.add}},[t._v("新建")]):t._e(),1==t.perData.allow_edit?n("el-button",{attrs:{type:"warning",size:"mini",icon:"el-icon-edit",disabled:t.isAdd||!t.isedit||t.isCheck||t.nullBtn},on:{click:t.handelEdit}},[t._v("修改")]):t._e(),1==t.perData.allow_dele?n("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",disabled:t.isAdd||!t.isedit||t.isCheck||t.nullBtn},on:{click:t.delStock}},[t._v("删除")]):t._e(),1==t.perData.allow_edit||1==t.perData.allow_add?n("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-document-checked",disabled:t.nullBtn||t.isedit},on:{click:t.saveIt}},[t._v("保存")]):t._e(),n("el-button",{attrs:{type:"info",size:"mini",icon:"el-icon-refresh-left",disabled:t.isCheck||t.nullBtn||t.isedit},on:{click:function(e){return t.refreshData(t.form.stockadjust_no)}}},[t._v("撤回")]),1==t.perData.allow_check?n("div",{staticClass:"checkboxProStock"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.form.check,expression:"form.check"}],attrs:{type:"checkbox",disabled:t.isAdd||!t.isedit,name:"审核"},domProps:{checked:1==t.form.check,checked:Array.isArray(t.form.check)?t._i(t.form.check,null)>-1:t.form.check},on:{change:[function(e){var a=t.form.check,n=e.target,s=!!n.checked;if(Array.isArray(a)){var i=null,o=t._i(a,i);n.checked?o<0&&t.$set(t.form,"check",a.concat([i])):o>-1&&t.$set(t.form,"check",a.slice(0,o).concat(a.slice(o+1)))}else t.$set(t.form,"check",s)},function(e){return t.isEdit(t.form.check)}]}}),n("span",{staticStyle:{"margin-left":"10px","margin-top":"10px","font-weight":"bold",color:"red"}},[t._v("审核")])]):t._e()],1)]),n("div",{staticStyle:{"text-align":"right","margin-top":"5px"}},[n("el-button",{attrs:{type:"warning",disabled:t.isAdd||!t.isedit,size:"mini"},on:{click:function(e){t.checkData.isshow=!0}}},[t._v("批量审核")])],1),n("el-form",{ref:"form",staticClass:"topForm",attrs:{model:t.form,"label-width":"100px"}},[n("el-row",{staticClass:"modify",attrs:{gutter:5}},[n("el-col",{attrs:{span:4,xs:24,sm:4,md:4,lg:4,xl:4}},[n("el-form-item",{attrs:{label:"创建人："}},[n("el-input",{attrs:{disabled:""},model:{value:t.form.build_name,callback:function(e){t.$set(t.form,"build_name",e)},expression:"form.build_name"}})],1)],1),n("el-col",{attrs:{span:4,xs:24,sm:4,md:4,lg:4,xl:4}},[n("el-form-item",{attrs:{label:"修改人："}},[n("el-input",{attrs:{disabled:""},model:{value:t.form.modify_name,callback:function(e){t.$set(t.form,"modify_name",e)},expression:"form.modify_name"}})],1)],1),n("el-col",{attrs:{span:6,xs:24,sm:6,md:6,lg:6,xl:6}},[n("el-form-item",{attrs:{label:"创建时间："}},[n("el-input",{attrs:{disabled:""},model:{value:t.form.build_date,callback:function(e){t.$set(t.form,"build_date",e)},expression:"form.build_date"}})],1)],1),n("el-col",{attrs:{span:6,xs:24,sm:6,md:6,lg:6,xl:6}},[n("el-form-item",{attrs:{label:"修改时间："}},[n("el-input",{attrs:{disabled:""},model:{value:t.form.modify_date,callback:function(e){t.$set(t.form,"modify_date",e)},expression:"form.modify_date"}})],1)],1),n("el-col",{attrs:{span:4,xs:24,sm:4,md:4,lg:4,xl:4}},[n("el-form-item",{attrs:{label:"审核人："}},[n("el-input",{attrs:{disabled:""},model:{value:t.form.check_name,callback:function(e){t.$set(t.form,"check_name",e)},expression:"form.check_name"}})],1)],1)],1),n("el-container",{staticClass:"stockcon",staticStyle:{background:"#fff","border-radius":"15px","padding-top":"20px","padding-right":"20px","margin-bottom":"10px"}},[n("el-main",{staticStyle:{padding:"0 20px 0 0"}},[n("el-row",{attrs:{gutter:5}},[n("el-col",{attrs:{span:7,xs:24,sm:7,md:7,lg:7,xl:7}},[n("el-form-item",{attrs:{label:"调整单号"}},[n("el-input",{attrs:{disabled:""},model:{value:t.form.stockadjust_no,callback:function(e){t.$set(t.form,"stockadjust_no",e)},expression:"form.stockadjust_no"}})],1)],1),n("el-col",{attrs:{span:7,xs:24,sm:7,md:7,lg:7,xl:7}},[n("el-form-item",{attrs:{label:"调整日期"}},[n("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime",disabled:t.isedit,"value-format":"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期"},model:{value:t.form.stockadjust_date,callback:function(e){t.$set(t.form,"stockadjust_date",e)},expression:"form.stockadjust_date"}})],1)],1),n("el-col",{staticStyle:{display:"flex","align-items":"flex-start","flex-wrap":"wrap"},attrs:{span:8,xs:24,sm:8,md:8,lg:8,xl:8}},[n("el-form-item",{attrs:{label:"柜台"}},[n("label",{attrs:{slot:"label"},slot:"label"},[t._v("柜       台")]),n("el-select",{attrs:{clearable:"","default-first-option":"",filterable:"",placeholder:"请选择",disabled:t.isedit},on:{"visible-change":function(e){return t.getRefreshPull()},change:function(e){return t.selCounter()}},model:{value:t.form.counter_no,callback:function(e){t.$set(t.form,"counter_no",e)},expression:"form.counter_no"}},t._l(t.pull_counter,(function(t,e){return n("el-option",{key:e,attrs:{label:t.kind_no+" - "+t.kind_name,value:t.kind_no.toString()}})})),1)],1),n("el-button",{staticStyle:{"margin-left":"5px"},attrs:{size:"small",disabled:!t.isAdd,type:"primary"},on:{click:t.reSet}},[t._v("库存重整")])],1)],1),n("el-row",{attrs:{gutter:5}},[n("el-col",[n("el-form-item",{attrs:{label:"备注"}},[n("label",{attrs:{slot:"label"},slot:"label"},[t._v("备       注")]),n("el-input",{attrs:{type:"textarea",rows:2,disabled:t.isedit},model:{value:t.form.remark,callback:function(e){t.$set(t.form,"remark",e)},expression:"form.remark"}})],1)],1)],1)],1),n("el-aside",{staticClass:"stockSide",attrs:{width:"100px"}},[n("el-carousel",{attrs:{"indicator-position":"none",autoplay:!1,height:"100px"}},t._l(t.imgArr,(function(e){return n("el-carousel-item",{key:e},[n("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e,alt:""},on:{click:function(a){return t.handlePictureCardPreview(e)}}})],1)})),1)],1)],1)],1),n("div",{staticStyle:{"margin-bottom":"10px","text-align":"right"}},[n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-plus",disabled:t.isedit},on:{click:function(e){return t.insertEvent(-1)}}},[t._v("新增数据")]),n("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",disabled:t.isedit},on:{click:function(e){return t.removeEvent()}}},[t._v("删除")])],1),n("div",{staticStyle:{"text-align":"center",background:"rgb(128, 0, 0)",color:"#fff","font-size":"12px",padding:"6px 0"}},[t._v("明细")]),n("vxe-table",{ref:"xTable1",staticClass:"stock2222",attrs:{border:"",stripe:"",resizable:"","keep-source":"",align:"center",height:"380","show-overflow":"","highlight-hover-row":"","edit-rules":t.validRules,loading:t.loading,"mouse-config":{selected:!0,area:!0},"keyboard-config":{isArrow:!0,isDel:!0,isEnter:!0,isTab:!0,isEdit:!0},"row-class-name":t.rowChange,data:t.form.dtl,"edit-config":{trigger:"click",mode:"cell",icon:"fa fa",activeMethod:t.activeRowMethod}},on:{"cell-click":t.choseIt}},[n("vxe-table-column",{attrs:{type:"checkbox",width:"40"}}),n("vxe-table-column",{attrs:{type:"seq",field:"seq",width:"50",title:"序号"}}),1==t.is_onlyone?n("vxe-table-column",{attrs:{field:"barcode_no",width:"150",title:"条码号","edit-render":{name:"$input",events:{keydown:t.enterFilterEvents}}}}):t._e(),n("vxe-table-column",{attrs:{title:"产品编号",width:"150",field:"style_no","edit-render":{}},scopedSlots:t._u([{key:"edit",fn:function(e){var a=e.row;return[n("el-select",{ref:"stylefocus",attrs:{filterable:"","default-first-option":"",placeholder:"请选择"},on:{change:function(e){return t.changeData(a)}},model:{value:a.style_no,callback:function(e){t.$set(a,"style_no",e)},expression:"row.style_no"}},t._l(t.allArr.style,(function(t){return n("el-option",{key:t.style_no,attrs:{label:t.style_no+" - "+t.style_name,value:t.style_no}})})),1)]}}])}),n("vxe-table-column",{attrs:{field:"style_name",title:"产品名称",width:"120"}}),n("vxe-table-column",{attrs:{field:"specs",width:"150",title:"规格","edit-render":{name:"input",attrs:{disabled:t.isedit}}}}),n("vxe-table-column",{attrs:{field:"counter_no",title:"柜台编号","edit-render":{name:"$select",options:t.allArr.counter,props:{clearable:!0,placeholder:"请输入",disabled:t.isedit,placeholder:"请选择"},optionProps:{value:"kind_no",label:"kind_name"},events:{change:t.selectCounter}},width:"120"}}),n("vxe-table-column",{attrs:{field:"old_qty",title:"原数量",width:"120"}}),n("vxe-table-column",{attrs:{field:"old_wgt",title:"原重量",width:"120"}}),n("vxe-table-column",{attrs:{title:"调整数量",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("span",[t._v(t._s(t.countAmount(a)?t.countAmount(a).toFixed(t.systemSet.qty):0))])]}}])}),n("vxe-table-column",{attrs:{title:"调整重量",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[n("span",[t._v(t._s(t.countWgt(a)?t.countWgt(a).toFixed(t.systemSet.wgt):0))])]}}])}),n("vxe-table-column",{attrs:{field:"qty",title:"实盘数量",width:"120","edit-render":{name:"input",attrs:{disabled:t.isedit,type:"number"}}},scopedSlots:t._u([{key:"edit",fn:function(e){var a=e.row;return[n("vxe-input",{attrs:{type:"number"},model:{value:a.qty,callback:function(e){t.$set(a,"qty",e)},expression:"row.qty"}})]}}])}),n("vxe-table-column",{attrs:{field:"wgt",title:"实盘重量",width:"120","edit-render":{name:"input",attrs:{disabled:t.isedit,type:"number"}}}}),n("vxe-table-column",{attrs:{field:"remark",align:"left",title:"备注","edit-render":{name:"input",attrs:{disabled:t.isedit},events:{keyup:t.enterFilterEvent}}}})],1),n("div",{staticClass:"stock22",staticStyle:{"margin-top":"10px"}},[n("vxe-table",{ref:"xTable2",attrs:{border:"",stripe:"",resizable:"","keep-source":"",size:"mini",align:"center",height:"180","show-overflow":"","highlight-hover-row":"",loading:t.loading,data:t.form.stock,"edit-config":{trigger:"click",mode:"cell",icon:"fa fa"}}},[n("vxe-table-column",{attrs:{title:"库存明细"}},[n("vxe-table-column",{attrs:{type:"seq",field:"seq",width:"50",title:"序号"}}),n("vxe-table-column",{attrs:{field:"style_no",title:"产品编号"}}),n("vxe-table-column",{attrs:{field:"style_name_no.style_name",title:"产品名称"}}),n("vxe-table-column",{attrs:{field:"qty",title:"数量","edit-render":{name:"$input",props:{type:"float",digits:t.systemSet.qty,disabled:!0}}}}),n("vxe-table-column",{attrs:{field:"wgt",title:"重量","edit-render":{name:"$input",props:{type:"float",digits:t.systemSet.wgt,disabled:!0}}}})],1)],1)],1),n("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[n("img",{attrs:{width:"100%",src:t.dialogImageUrl,alt:""}})]),n("el-dialog",{staticStyle:{padding:"0 20px"},attrs:{title:"筛选",visible:t.outData.isshow,width:"60%"},on:{"update:visible":function(e){return t.$set(t.outData,"isshow",e)}}},[n("div",{staticClass:"box1"},[n("el-button",{attrs:{type:"success",icon:"el-icon-plus",plain:"",circle:""},on:{click:t.showInput}}),t._l(t.bonusData.field,(function(e,a){return n("div",{key:a,staticStyle:{"margin-top":"20px",display:"flex","flex-wrap":"wrap","align-items":"center"}},[n("el-select",{attrs:{filterable:"",clearable:"","default-first-option":"",placeholder:"请选择"},on:{change:function(e){return t.selectOne(a)}},model:{value:t.bonusData.field[a],callback:function(e){t.$set(t.bonusData.field,a,e)},expression:"bonusData.field[index]"}},t._l(t.allArr.screen_pull,(function(t){return n("el-option",{key:t.style_no,attrs:{label:t.table_name,value:t.table}})})),1),n("span",{staticStyle:{display:"inline-block",margin:"0 10px"}},[t._v("-")]),n("el-select",{attrs:{filterable:"",clearable:"","default-first-option":"",placeholder:"请选择"},on:{change:function(e){return t.selectOne1(a)}},model:{value:t.bonusData.table[a],callback:function(e){t.$set(t.bonusData.table,a,e)},expression:"bonusData.table[index]"}},t._l(t.allArr.screen_pull[t.arr[a]?t.arr[a]:0].field,(function(t){return n("el-option",{key:t.name_no,attrs:{label:t.name,value:t.name_no}})})),1),n("span",{staticStyle:{display:"inline-block",margin:"0 10px"}},[t._v("-")]),n("el-select",{attrs:{filterable:"",clearable:"","default-first-option":"",placeholder:"请选择"},model:{value:t.bonusData.condition[a],callback:function(e){t.$set(t.bonusData.condition,a,e)},expression:"bonusData.condition[index]"}},t._l(t.allArr.screen_condition,(function(t){return n("el-option",{key:t.name_no,attrs:{label:t.name,value:t.name_no}})})),1),n("span",{staticStyle:{display:"inline-block",margin:"0 10px"}},[t._v("-")]),t.allArr.screen_pull[t.arr[a]?t.arr[a]:0].field[t.arrs[a]?t.arrs[a]:0].select?n("el-select",{attrs:{filterable:"",clearable:"","default-first-option":"",placeholder:"请选择"},model:{value:t.bonusData.parameter[a],callback:function(e){t.$set(t.bonusData.parameter,a,e)},expression:"bonusData.parameter[index]"}},t._l(t.allArr.screen_pull[t.arr[a]?t.arr[a]:0].field[t.arrs[a]?t.arrs[a]:0].select,(function(t){return n("el-option",{key:t.kind_no,attrs:{label:t.kind_name,value:t.kind_no}})})),1):n("el-input",{staticStyle:{width:"20%"},attrs:{placeholder:"请输入"},model:{value:t.bonusData.parameter[a],callback:function(e){t.$set(t.bonusData.parameter,a,e)},expression:"bonusData.parameter[index]"}}),n("el-button",{staticStyle:{"margin-left":"15px"},attrs:{type:"danger",icon:"el-icon-minus",plain:"",circle:"",size:"small"},nativeOn:{click:function(e){return e.preventDefault(),t.deleteRow(a,t.bonusData)}}})],1)}))],2),t.searchData.length?n("el-table",{staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.searchData}},[n("el-table-column",{attrs:{prop:"index",label:"调整单号"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row))])]}}],null,!1,1525313800)}),n("el-table-column",{attrs:{label:"操作",width:"250",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-edit"},on:{click:function(a){return t.searchIt(e.row)}}},[t._v("查看详情")])]}}],null,!1,859597681)})],1):t._e(),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:t.saveOk}},[t._v("确 定")]),n("el-button",{on:{click:function(e){t.outData.isshow=!1}}},[t._v("取 消")])],1)],1),n("el-dialog",{staticStyle:{padding:"0 20px"},attrs:{title:"导出",visible:t.excelData.isshow,width:"60%"},on:{"update:visible":function(e){return t.$set(t.excelData,"isshow",e)}}},[n("div",{staticClass:"pro",staticStyle:{"text-align":"center"}},[n("el-select",{staticStyle:{display:"block",width:"50%",margin:"0 auto"},attrs:{clearable:"","default-first-option":"",placeholder:"请选择"},model:{value:t.excelValue,callback:function(e){t.excelValue=e},expression:"excelValue"}},[n("el-option",{attrs:{label:"调整",value:"调整"}},[t._v("调整")]),n("el-option",{attrs:{label:"调整明细",value:"调整明细"}},[t._v("调整明细")])],1),n("el-input",{staticStyle:{display:"block",width:"50%",margin:"10px auto"},attrs:{placeholder:"请输入调整单号"},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),n("el-select",{staticStyle:{display:"block",width:"50%",margin:"0 auto 10px"},attrs:{filterable:"",clearable:"","default-first-option":"",placeholder:"请选择柜台"},model:{value:t.counter,callback:function(e){t.counter=e},expression:"counter"}},t._l(t.allArr.counter,(function(t,e){return n("el-option",{key:e,attrs:{label:t.kind_name,value:t.kind_no}})})),1),"调整"==t.excelValue?n("div",{staticStyle:{display:"block",width:"50%",margin:"0 auto 10px"}},[n("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.subscribe_date,callback:function(e){t.subscribe_date=e},expression:"subscribe_date"}})],1):t._e(),"调整明细"==t.excelValue?n("el-select",{staticStyle:{display:"block",width:"50%",margin:"0 auto 10px"},attrs:{filterable:"",clearable:"","default-first-option":"",placeholder:"请选择产品"},model:{value:t.style_no,callback:function(e){t.style_no=e},expression:"style_no"}},t._l(t.allArr.style,(function(t,e){return n("el-option",{key:e,attrs:{label:t.style_name,value:t.style_no}})})),1):t._e(),n("div",{staticStyle:{display:"flex","align-items":"center","margin-top":"30px","justify-content":"center"}},[n("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success",icon:"el-icon-download"},on:{click:t.outExcel}},[t._v("导出")]),n("el-button",{attrs:{type:"primary",icon:"el-icon-download"},on:{click:t.outTem}},[t._v("模板导出")])],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.excelData.isshow=!1}}},[t._v("取 消")])],1)]),n("el-dialog",{staticStyle:{padding:"0 20px"},attrs:{title:"批量审核",visible:t.checkData.isshow,width:"60%"},on:{"update:visible":function(e){return t.$set(t.checkData,"isshow",e)}}},[n("el-form",{attrs:{"label-width":"100px"}},[n("el-form-item",{attrs:{label:"开始日期"}},[n("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.checkData.data.begin_date,callback:function(e){t.$set(t.checkData.data,"begin_date",e)},expression:"checkData.data.begin_date"}})],1),n("el-form-item",{attrs:{label:"结束日期"}},[n("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:t.checkData.data.end_date,callback:function(e){t.$set(t.checkData.data,"end_date",e)},expression:"checkData.data.end_date"}})],1),n("div",{staticStyle:{"text-align":"center"}},[n("el-button",{staticStyle:{"margin-right":"30px"},attrs:{type:"success"},on:{click:function(e){return t.saveCheck("1")}}},[t._v("审 核")]),n("el-button",{attrs:{type:"warning"},on:{click:function(e){return t.saveCheck("0")}}},[t._v("反审核")])],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(e){t.checkData.isshow=!1}}},[t._v("取 消")])],1)],1)],1)},s=[],i=(a("96cf"),a("1da1")),o=a("fd03"),l={name:"stockmanage",data:function(){return{is_onlyone:"",bonusData:{field:[],table:[],condition:[],parameter:[]},tableIndex:0,tableNo:0,searchData:[],arr:[],arrs:[],counter:"",style_no:"",subscribe_date:"",tableData:[],allArr:"",form:{},isedit:!0,isCheck:!1,prev:null,next:null,dialogImageUrl:"",dialogVisible:!1,outData:{isshow:!1,scope:null,index:0,data:{}},excelData:{isshow:!1,scope:null,index:0,data:{}},checkData:{isshow:!1,scope:null,index:0,data:{}},keyword:"",isAdd:!1,loading:!1,excelValue:"",imgArr:[],pull_counter:[],pull_style:[],perData:"",usedCounter:"",nullBtn:!1,systemSet:"",validRules:{style_no:[{required:!0,message:"产品编号必须填写"}],qty:[{required:!0,message:"实盘数量必须填写"}],wgt:[{required:!0,message:"实盘重量必须填写"}]},username:""}},created:function(){this.geData(),this.getStoneData(),this.getPermission(),this.getSystem()},watch:{},methods:{geData:function(){var t=this,e=this.$loading({lock:!0,text:"拼命加载中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});this.isAdd=!1,Object(o["nd"])({}).then((function(a){if(2e3==a.code){if(e.close(),t.form=a.data.data,t.next=a.data.next,t.prev=a.data.prev,1==t.form.check&&(t.isCheck=!0),a.data.data.dtl[0]){var n=[];for(var s in a.data.data.dtl[0].style_img)a.data.data.dtl[0].style_img[s]&&n.push(a.data.data.dtl[0].style_img[s]);t.imgArr=n}}else e.close(),"无数据请先添加"!=a.data.info&&"没有这条数据"!=a.data.info||(t.form={dtl:[],stock:[]},t.nullBtn=!0),t.$message.error(a.data.info)}))},getStoneData:function(){var t=this;Object(o["cb"])({}).then((function(e){2e3==e.code?(t.allArr=e.data,t.pull_counter=e.data.counter,t.pull_style=e.data.style,t.usedCounter=e.data.user_counter,t.is_onlyone=e.data.params.is_onlyone):t.$message.error(e.msg)}))},searchIt:function(t){var e=this;Object(o["cg"])({stockadjust_no:t}).then((function(t){2e3==t.code?(e.form=t.data.data,e.next=t.data.next,e.prev=t.data.prev,e.outData.isshow=!1,1==e.form.check?e.isCheck=!0:e.isCheck=!1):e.$message.error(t.data.info)}))},refreshData:function(t){this.isedit=!0,this.isAdd=!1,null==t?this.geData():this.searchIt(t)},handelEdit:function(){var t=this;Object(o["xj"])({stockadjust_no:this.form.stockadjust_no}).then((function(e){console.log(e),2e3==e.code?1==t.isedit&&(0==t.form.check?t.isedit=!1:1==t.form.check&&(t.isCheck=!0)):t.$message.error(e.data.info)}))},saveIt:function(){var t=this,e=this.form,a=this.$refs.xTable1.getTableData().tableData;e["dtl"]=a,e["check"]=1==this.form.check?"1":"0",this.$load.show(),1==this.isAdd?Object(o["ch"])(e).then((function(e){2e3==e.code?(t.$message.success("添加成功"),t.form=e.data.data,t.next=e.data.next,t.prev=e.data.prev,t.isAdd=!1,t.isedit=!0):t.$message.error(e.data.info),t.$load.close()})):Object(o["Ld"])(e).then((function(e){2e3==e.code?(t.$message.success("修改成功"),t.form=e.data.data,t.next=e.data.next,t.prev=e.data.prev,t.isedit=!0):t.$message.error(e.data.info),t.$load.close()}))},add:function(){0==this.isAdd?(this.isedit=!1,this.form={stockadjust_date:"",dtl:[],stock:[]},this.imgArr=[],this.form.check=!1,this.isAdd=!0,this.isCheck=!1,this.nullBtn=!1,this.form.stockadjust_date=this.$getTime(),this.usedCounter&&(this.form.counter_no=this.usedCounter.outcounter_no,this.form.counter_no&&this.selCounter())):this.$message.error("请先保存再添加下一个")},delStock:function(){var t=this;this.$confirm("确定要删除该库存调整管理单吗？","提示",{type:"warning"}).then((function(){Object(o["cc"])({stockadjust_no:t.form.stockadjust_no}).then((function(e){2e3==e.code?(t.$message({message:"删除成功",type:"success"}),null==e.data.data?(t.form={},t.nullBtn=!0):(t.form=e.data.data,1==t.form.check?t.isCheck=!0:t.isCheck=!1),t.next=e.data.next,t.prev=e.data.prev):t.$message.error(e.data.info)}))})).catch((function(){}))},rowChange:function(t){t.row.seq=t.seq},isEdit:function(t){var e=this;Object(o["zh"])({stockadjust_no:this.form.stockadjust_no,check:1==this.form.check?"1":"0"}).then((function(t){2e3==t.code?(1==e.form.check?e.isCheck=!0:(e.isedit=!0,e.isCheck=!1),e.$message.success(t.msg)):(e.$message.error(t.data.info),1==e.form.check?e.form.check=0:e.form.check=1)}))},firstPage:function(){var t=this,e=this.$loading({lock:!0,text:"拼命加载中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});Object(o["uc"])({}).then((function(a){2e3==a.code?(e.close(),t.form=a.data.data,t.next=a.data.next,t.prev=a.data.prev,1==t.form.check?t.isCheck=!0:t.isCheck=!1):(e.close(),t.$message.error(a.data.info))}))},lastPage:function(){var t=this,e=this.$loading({lock:!0,text:"拼命加载中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});Object(o["nd"])({}).then((function(a){2e3==a.code?(e.close(),t.form=a.data.data,t.next=a.data.next,t.prev=a.data.prev,1==t.form.check?t.isCheck=!0:t.isCheck=!1):(e.close(),t.$message.error(a.data.info))}))},nextPage:function(){var t=this,e=this.$loading({lock:!0,text:"拼命加载中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});Object(o["ie"])({stockadjust_no:this.form.stockadjust_no}).then((function(a){2e3==a.code?(e.close(),t.form=a.data.data,t.next=a.data.next,t.prev=a.data.prev,1==t.form.check?t.isCheck=!0:t.isCheck=!1):(e.close(),t.$message.error(a.data.info))}))},prevPage:function(){var t=this,e=this.$loading({lock:!0,text:"拼命加载中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.5)"});Object(o["of"])({stockadjust_no:this.form.stockadjust_no}).then((function(a){2e3==a.code?(e.close(),t.form=a.data.data,t.next=a.data.next,t.prev=a.data.prev,1==t.form.check?t.isCheck=!0:t.isCheck=!1):(e.close(),t.$message.error(a.data.info))}))},insertEvent:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(e){var a,n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={style_no:"",counter_no:this.form.counter_no,qty:"0",wgt:"0"},t.next=3,this.$refs.xTable1.insertAt(a,e);case 3:return n=t.sent,s=n.row,t.next=7,this.$refs.xTable1.setActiveCell(s,"style_no","counter_no","qty","wgt");case 7:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),removeEvent:function(){var t=this,e=this.$refs.xTable1.getCheckboxRecords();0==e.length?this.$message.error("请选择你要删除的"):this.$XModal.confirm("您确定要删除该数据?").then((function(e){"confirm"===e&&t.$refs.xTable1.removeCheckboxRow()}))},enterFilterEvent:function(t,e){t.$panel,t.row;13===e.keyCode&&this.insertEvent(-1)},handlePictureCardPreview:function(t){this.dialogImageUrl=t,this.dialogVisible=!0},showOut:function(){var t=this;this.excelData.isshow=!0,Object(o["wc"])({}).then((function(e){2e3==e.code?t.username=e.data.login_staff:t.$message.error(e.msg)}))},outExcel:function(){var t=this,e=this.username;this.excelData.isshow=!1,this.$axios.get(this.$baseURL+"stockadjust_export",{params:{token:sessionStorage.getItem("userToken"),login_staff:e,stockadjust_no:this.keyword,type:this.excelValue,counter_no:this.counter,style_no:this.style_no,stockadjust_date:this.subscribe_date},responseType:"arraybuffer"}).then((function(e){var a=new Blob([e.data],{type:"application/x-xls"}),n=document.createElement("a");n.href=window.URL.createObjectURL(a),n.download=t.excelValue+".xlsx",n.click()}))},outTem:function(){var t=this;this.$axios.get(this.$baseURL+"stockadjust_template_export",{params:{token:sessionStorage.getItem("userToken"),type:this.excelValue},responseType:"arraybuffer"}).then((function(e){var a=new Blob([e.data],{type:"application/x-xls"}),n=document.createElement("a");n.href=window.URL.createObjectURL(a),n.download=t.excelValue+"模板.xlsx",n.click()}))},activeRowMethod:function(){return 0==this.isedit||(this.$message.error("该状态下不可编辑"),!1)},choseIt:function(t){var e=[];for(var a in t.row.style_img)t.row.style_img[a]&&e.push(t.row.style_img[a]),this.imgArr=e},enterFilterEvents:function(t,e){var a=this,n=(t.$panel,t.row),s=this.$refs.xTable1.getTableData().tableData;if(13===e.$event.keyCode){for(var i=0;i<s.length;i++)for(var l=i+1;l<s.length;l++)if(s[i].barcode_no&&s[i].barcode_no===s[l].barcode_no)return n.barcode_no="",void this.$message.error("条形码不能有重复的,请重新输入");Object(o["tj"])({barcode_no:n.barcode_no,counter_no:this.form.counter_no}).then((function(t){if(2e3==t.code){if(t.data.style_no){a.changeData(t.data),n.style_no=t.data.style_no,n.style_name=t.data.style_name,n.old_qty=t.data.qty,n.barcode_no=t.data.barcode_no,n.old_wgt=t.data.wgt,n.add_wage=t.data.add_wage,n.gross_wgt=t.data.gross_wgt,n.discount=t.data.discount,n.amt=t.data.amt,n.remark=t.data.remark,n.specs=t.data.specs;for(var e=0;e<s.length;e++)s[e].style_no&&(s[e].qty=1)}a.insertEvent(-1),a.$forceUpdate()}else a.$message.error(t.data.info)}))}},changeData:function(t){console.log(t,"row");var e=this.allArr.style.filter((function(e){return e.style_no==t.style_no})),a=this.allArr.style.filter((function(e){return e.style_no==t.style_no}));t.style_no&&(this.imgArr=a[0].img,t.style_name=e[0].style_name)},selectName:function(t){var e=this.allArr.style.filter((function(e){return e.style_no==t.row.style_name})),a=this.allArr.style.filter((function(e){return e.style_no==t.row.style_name}));t.row.style_name&&(t.row.style_no=e[0].style_no,this.imgArr=a[0].img)},countAmount:function(t){var e=t.qty-t.old_qty;return t.adjust_qty=e,e},countWgt:function(t){var e=t.wgt-t.old_wgt;return t.adjust_wgt=e,e},getPermission:function(){var t=this;Object(o["xb"])({id:"33"}).then((function(e){2e3==e.code?t.perData=e.data:t.$message.error(e.msg)}))},showInput:function(){null==this.bonusData.field&&(this.bonusData.field=[]),null==this.bonusData.table&&(this.bonusData.table=[]),null==this.bonusData.condition&&(this.bonusData.condition=[]),null==this.bonusData.parameter&&(this.bonusData.parameter=[]);var t="";this.bonusData.field.push(t),this.bonusData.table.push(t),this.bonusData.condition.push(t),this.bonusData.parameter.push(t)},selectOne:function(t){for(var e=0;e<this.allArr.screen_pull.length;e++)this.allArr.screen_pull[e].table==this.bonusData.field[t]&&(this.tableIndex=e);this.arr[t]=this.tableIndex},selectOne1:function(t){for(var e=0;e<this.allArr.screen_pull[this.arr[t]].field.length;e++)this.allArr.screen_pull[this.arr[t]].field[e].name_no==this.bonusData.table[t]&&(this.tableNo=e);this.arrs[t]=this.tableNo},deleteRow:function(t,e){for(var a=0;a<e.field.length;a++)e.field[a]==this.bonusData.field[t]&&(e.field.splice(a,1),e.table.splice(a,1),e.condition.splice(a,1),e.parameter.splice(a,1))},saveOk:function(){for(var t=this,e=[],a=0;a<this.bonusData.field.length&&this.bonusData.table.length&&this.bonusData.condition.length&&this.bonusData.parameter.length;a++)e[a]={},e[a].table=this.bonusData.field[a],e[a].field=this.bonusData.table[a],e[a].condition=this.bonusData.condition[a],e[a].parameter=this.bonusData.parameter[a];Object(o["Rh"])({data:e}).then((function(e){2e3==e.code?t.searchData=e.data:t.$message.error(e.data.info)}))},reSet:function(){var t=this;Object(o["tb"])({counter_no:this.form.counter_no,end_date:this.form.stockadjust_date}).then((function(e){2e3==e.code?t.form.dtl=e.data:t.$message.error(e.data.info)}))},selectCounter:function(t){var e=this;Object(o["vb"])({style_no:t.row.style_no,counter_no:t.row.counter_no}).then((function(a){2e3==a.code?a.data.length>0?(t.row.old_wgt=a.data[0].old_wgt,t.row.old_qty=a.data[0].old_qty,t.row.qty=a.data[0].qty,t.row.wgt=a.data[0].wgt):(t.row.old_wgt="0",t.row.old_qty="0",t.row.qty="0",t.row.wgt="0"):e.$message.error(a.data.info)}))},searchCounter:function(t){if(this.form.counter_no=t,t){for(var e=this.allArr.counter,a=[],n=0;n<e.length;n++)(e[n].kind_no.toLowerCase().indexOf(t.toLowerCase())>=0||e[n].kind_name.indexOf(t)>=0)&&a.push(e[n]);this.pull_counter=a}else this.pull_counter=this.allArr.counter},refreshs:function(){this.$forceUpdate()},getSystem:function(){var t=this;Object(o["gg"])({}).then((function(e){2e3==e.code?t.systemSet=e.data:t.$message.error(e.data.info)}))},selCounter:function(){var t=this;this.form.counter_no&&Object(o["ub"])({counter_no:this.form.counter_no}).then((function(e){2e3==e.code?t.form.stock=e.data:t.$message.error(e.data.info)}))},getRefreshPull:function(){this.pull_counter=this.allArr.counter},saveCheck:function(t){var e=this,a=this.checkData.data;Object(o["sb"])({begin_date:a.begin_date,end_date:a.end_date,check:t}).then((function(t){2e3==t.code?(e.$message.success(t.msg),e.searchIt(e.form.stockadjust_no),e.checkData.isshow=!1):e.$message.error(t.data.info)}))}}},r=l,c=(a("c6c1"),a("d6b7"),a("2877")),d=Object(c["a"])(r,n,s,!1,null,"7ceb13e9",null);e["default"]=d.exports},"74f4":function(t,e,a){},"8df0":function(t,e,a){},b887:function(t,e,a){t.exports=a.p+"img/last1.b6402fd3.png"},c6c1:function(t,e,a){"use strict";var n=a("8df0"),s=a.n(n);s.a},d6b7:function(t,e,a){"use strict";var n=a("74f4"),s=a.n(n);s.a},e484:function(t,e,a){t.exports=a.p+"img/next1.ab2ca5a8.png"}}]);
//# sourceMappingURL=chunk-2b4d502e.1f045cf1.js.map