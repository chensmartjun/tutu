(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1c892234"],{"727d":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{background:"#fff",padding:"20px"}},[a("el-button",{staticStyle:{float:"right"},attrs:{type:"info"},on:{click:t.outExcel}},[t._v("导出EXCEL")]),1==t.perData.allow_print?a("el-button",{staticStyle:{float:"right",margin:"0 10px"},attrs:{type:"primary"},on:{click:t.printContext}},[t._v("打印")]):t._e(),1==t.perData.allow_print?a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:t.toImg}},[t._v("转图片下载")]):t._e(),a("el-button",{staticStyle:{float:"right"},attrs:{type:"warning"},on:{click:function(e){t.outData.isshow=!0}}},[t._v("筛选")]),a("el-radio-group",{staticClass:"raio",attrs:{size:"medium"},on:{change:t.selectTable},model:{value:t.table,callback:function(e){t.table=e},expression:"table"}},[a("el-radio-button",{attrs:{label:"明细"}}),a("el-radio-button",{attrs:{label:"柜台"}}),a("el-radio-button",{attrs:{label:"品类"}})],1),a("div",{ref:"print",staticClass:"totaltable",staticStyle:{"page-break-after":"always",padding:"10px","margin-top":"30px",height:"100%"},attrs:{id:"print"}},[t.systemSet.company?a("p",{staticClass:"company"},[t._v(t._s(t.systemSet.company))]):t._e(),"明细"==t.table&&""!=t.dtlArr?a("div",{staticStyle:{"text-align":"center"}},[a("div",{staticStyle:{"font-size":"16px","font-weight":"bold","margin-bottom":"10px",position:"relative"}},[a("span",{staticStyle:{position:"absolute",left:"0"}},[t._v("打印时间："+t._s(t.datetime))]),t._v("库存明细表\n            ")]),a("table",{attrs:{border:"1",cellpadding:"0",cellspacing:"0"}},[t._m(0),t._l(t.dtlArr,(function(e,n){return a("tr",{key:n,style:"合计"==e.counter_name?"color:red;font-weight: 700;":"",attrs:{align:"center"}},[e.counter_name_s?a("td",{staticStyle:{background:"#fff"},attrs:{rowspan:e.counter_count_s}},[t._v("\n                        "+t._s("这里是一个空值哈哈哈哈"==e.counter_name?"":e.counter_name)+"\n                    ")]):t._e(),a("td",[t._v(t._s(e.style_no))]),a("td",[t._v(t._s(e.style_name))]),a("td",[t._v(t._s(e.qty))]),a("td",[t._v(t._s(e.wgt))]),a("td",[t._v(t._s(e.sale_price))]),a("td",[t._v(t._s(e.amt))])])}))],2)]):t._e(),"柜台"==t.table&&""!=t.counterList?a("div",[a("div",{staticStyle:{"font-size":"16px","font-weight":"bold","text-align":"center",position:"relative"}},[t._v("\n                库存总表（按柜台）"),a("span",{staticStyle:{position:"absolute",left:"0"}},[t._v("打印时间："+t._s(t.datetime))])]),t._l(t.counterList,(function(e,n){return a("div",{key:n},[a("p",{staticStyle:{"font-weight":"bold","margin-top":"10px"}},[t._v(t._s(e.name))]),a("table",{attrs:{border:"1",cellpadding:"0",cellspacing:"0"}},[t._m(1,!0),t._l(e.data,(function(e,n){return a("tr",{key:n,attrs:{align:"center"}},[e.name?a("td",[t._v(t._s(e.name))]):a("td",[t._v("-")]),e.style_no?a("td",[t._v(t._s(e.style_no))]):a("td",[t._v("-")]),e.style_name?a("td",[t._v(t._s(e.style_name))]):a("td",[t._v("-")]),e.qty?a("td",[t._v(t._s(e.qty))]):a("td",[t._v("-")]),e.wgt?a("td",[t._v(t._s(e.wgt))]):a("td",[t._v("-")]),e.qty_prc?a("td",[t._v(t._s(e.qty_prc))]):a("td",[t._v("-")]),e.sale_price?a("td",[t._v(t._s(e.sale_price))]):a("td",[t._v("-")]),e.amt?a("td",[t._v(t._s(e.amt))]):a("td",[t._v("-")])])})),a("tr",{staticStyle:{color:"red","font-weight":"bold"},attrs:{align:"center"}},[a("td",[t._v("总计")]),a("td",[t._v("-")]),a("td",[t._v("-")]),a("td",[t._v(t._s(e.total.qty))]),a("td",[t._v(t._s(e.total.wgt))]),a("td",[t._v("-")]),a("td",[t._v("-")]),a("td",[t._v(t._s(e.total.amt))])])],2)])}))],2):t._e(),"品类"==t.table&&""!=t.kindArr?a("div",{staticStyle:{"text-align":"center"}},[a("div",{staticStyle:{"font-size":"16px","font-weight":"bold","margin-bottom":"10px",position:"relative"}},[a("span",{staticStyle:{position:"absolute",left:"0"}},[t._v("打印时间："+t._s(t.datetime))]),t._v("库存总表（按品类）\n            ")]),a("p",{staticStyle:{"font-size":"13px"}},[t._v("截止到："+t._s(t.kindData))]),a("table",{attrs:{border:"1",cellpadding:"0",cellspacing:"0"}},[t._m(2),t._l(t.kindArr,(function(e,n){return a("tr",{key:n,attrs:{align:"center"}},[e.name?a("td",[t._v(t._s(e.name))]):a("td",[t._v("-")]),e.qty?a("td",[t._v(t._s(e.qty))]):a("td",[t._v("-")]),e.wgt?a("td",[t._v(t._s(e.wgt))]):a("td",[t._v("-")]),e.amt?a("td",[t._v(t._s(e.amt))]):a("td",[t._v("-")])])})),a("tr",{staticStyle:{color:"red","font-weight":"bold"},attrs:{align:"center"}},[a("td",[t._v("总计")]),a("td",[t._v(t._s(t.kindTotal.qty))]),a("td",[t._v(t._s(t.kindTotal.wgt))]),a("td",[t._v(t._s(t.kindTotal.amt))])])],2)]):t._e(),a("big-name")],1),"明细"==t.table?a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":t.pageIndex3,"page-size":t.pageSize3,"page-sizes":[30,40,50],total:t.pageTotal3},on:{"current-change":t.handlePageChange3,"size-change":t.pageSizeChange3}})],1):t._e(),"柜台"==t.table?a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":t.pageIndex2,"page-size":t.pageSize2,"page-sizes":[30,40,50],total:t.pageTotal2},on:{"current-change":t.handlePageChange2,"size-change":t.pageSizeChange2}})],1):t._e(),"品类"==t.table?a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":t.pageIndex,"page-size":t.pageSize,"page-sizes":[30,40,50],total:t.pageTotal1},on:{"current-change":t.handlePageChange,"size-change":t.pageSizeChange}})],1):t._e(),a("el-dialog",{staticStyle:{padding:"0 20px"},attrs:{title:"筛选",visible:t.outData.isshow,width:"60%"},on:{"update:visible":function(e){return t.$set(t.outData,"isshow",e)}}},[a("div",{staticClass:"box1"},[a("el-button",{attrs:{type:"success",icon:"el-icon-plus",plain:"",circle:""},on:{click:t.showInput}}),t._l(t.bonusData.table,(function(e,n){return a("div",{key:n,staticStyle:{"margin-top":"20px",display:"flex","flex-wrap":"wrap","align-items":"center"}},["明细"==t.table?a("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:function(e){return t.selectOne1(n)}},model:{value:t.bonusData.table[n],callback:function(e){t.$set(t.bonusData.table,n,e)},expression:"bonusData.table[index]"}},t._l(t.allArr.dtl_pull[0].field,(function(t){return a("el-option",{key:t.name_no,attrs:{label:t.name,value:t.name_no}})})),1):a("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:function(e){return t.selectOne1(n)}},model:{value:t.bonusData.table[n],callback:function(e){t.$set(t.bonusData.table,n,e)},expression:"bonusData.table[index]"}},t._l(t.allArr.screen_pull[0].field,(function(t){return a("el-option",{key:t.name_no,attrs:{label:t.name,value:t.name_no}})})),1),a("span",{staticStyle:{display:"inline-block",margin:"0 10px"}},[t._v("-")]),a("el-select",{attrs:{filterable:"",placeholder:"请选择"},on:{change:function(e){return t.selectOne_vague(n)}},model:{value:t.bonusData.condition[n],callback:function(e){t.$set(t.bonusData.condition,n,e)},expression:"bonusData.condition[index]"}},t._l(t.allArr.screen_condition,(function(t){return a("el-option",{key:t.name_no,attrs:{label:t.name,value:t.name_no}})})),1),a("span",{staticStyle:{display:"inline-block",margin:"0 10px"}},[t._v("-")]),"明细"==t.table&&t.allArr.dtl_pull[0].field[t.arrs[n]?t.arrs[n]:0].select&&t.vague?a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:t.bonusData.parameter[n],callback:function(e){t.$set(t.bonusData.parameter,n,e)},expression:"bonusData.parameter[index]"}},t._l(t.allArr.dtl_pull[0].field[t.arrs[n]?t.arrs[n]:0].select,(function(t,e){return a("el-option",{key:e,attrs:{label:t.kind_name,value:t.kind_no}})})),1):("柜台"==t.table||"品类"==t.table)&&t.allArr.screen_pull[0].field[t.arrs[n]?t.arrs[n]:0].select&&t.vague?a("el-select",{attrs:{filterable:"",placeholder:"请选择"},model:{value:t.bonusData.parameter[n],callback:function(e){t.$set(t.bonusData.parameter,n,e)},expression:"bonusData.parameter[index]"}},t._l(t.allArr.screen_pull[0].field[t.arrs[n]?t.arrs[n]:0].select,(function(t,e){return a("el-option",{key:e,attrs:{label:t.kind_name,value:t.kind_no}})})),1):a("el-input",{staticStyle:{width:"20%"},attrs:{placeholder:"请输入"},model:{value:t.bonusData.parameter[n],callback:function(e){t.$set(t.bonusData.parameter,n,e)},expression:"bonusData.parameter[index]"}}),a("el-button",{staticStyle:{"margin-left":"15px"},attrs:{type:"danger",icon:"el-icon-minus",plain:"",circle:"",size:"small"},nativeOn:{click:function(e){return e.preventDefault(),t.deleteRow(n,t.bonusData)}}})],1)}))],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:t.saveOk}},[t._v("确 定")]),a("el-button",{on:{click:function(e){t.outData.isshow=!1}}},[t._v("取 消")])],1)])],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",{attrs:{align:"center"}},[a("th",[t._v("柜号")]),a("th",[t._v("编号")]),a("th",[t._v("品名")]),a("th",[t._v("数量")]),a("th",[t._v("重量")]),a("th",[t._v("单价")]),a("th",{staticStyle:{color:"red"}},[t._v("参考价值")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",{attrs:{align:"center"}},[a("th",{staticStyle:{width:"10%"}},[t._v("品类")]),a("th",{staticStyle:{width:"12%"}},[t._v("编号")]),a("th",{staticStyle:{width:"12%"}},[t._v("金料")]),a("th",{staticStyle:{width:"12%"}},[t._v("数量")]),a("th",{staticStyle:{width:"12%"}},[t._v("重量")]),a("th",{staticStyle:{width:"14%"}},[t._v("数单价")]),a("th",{staticStyle:{width:"14%"}},[t._v("重单价")]),a("th",{staticStyle:{width:"14%"}},[t._v("折算金额")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("tr",{attrs:{align:"center"}},[a("th",[t._v("品类")]),a("th",[t._v("数量")]),a("th",[t._v("重量")]),a("th",[t._v("折算金额")])])}],l=(a("34ef"),a("28a5"),a("fd03")),s=(a("add5"),a("c0e9")),o=a.n(s),r={name:"totalTable",data:function(){return{table:"明细",kindArr:[],kindTotal:"",kindData:"",counterList:[],dtlArr:[],outData:{isshow:!1,scope:null,index:0,data:{}},bonusData:{field:[],table:[],condition:[],parameter:[]},tableIndex:0,tableNo:0,arr:[],arrs:[],allArr:"",perData:"",systemSet:"",pageIndex:1,pageSize:30,pageIndex2:1,pageSize2:30,pageIndex3:1,pageSize3:30,pageTotal1:0,pageTotal2:0,pageTotal3:0,username:"",datetime:"",arrBigs:"",vague:!0}},watch:{table:function(t,e){this.bonusData={table:[],condition:[],parameter:[]},this.pageIndex=1,this.arrBigs=""}},created:function(){this.selectTable(),this.getPull(),this.getPermission(),this.getSystem(),this.getUserInfo()},methods:{getUserInfo:function(){var t=this;Object(l["wc"])({}).then((function(e){2e3==e.code?t.username=e.data.login_staff:t.$message.error(e.msg)}))},getPull:function(){var t=this;Object(l["hj"])({}).then((function(e){2e3==e.code?t.allArr=e.data:t.$message.error(e.data.info)}))},selectTable:function(){var t=this;this.$load.show(),"品类"==this.table?Object(l["gj"])({type:"品类",page:this.pageIndex,page_size:this.pageSize,data:this.arrBigs}).then((function(e){2e3==e.code?(t.datetime=e.data.datetime,t.kindArr=e.data.data,t.kindTotal=e.data.data_total,t.kindData=e.data.datetime,t.pageTotal1=e.data.total):t.$message.error(e.data.info)})):"柜台"==this.table?Object(l["gj"])({type:"柜台",page:this.pageIndex2,page_size:this.pageSize2}).then((function(e){2e3==e.code?(t.datetime=e.data.datetime,t.counterList=e.data.data,t.pageTotal2=e.data.total):t.$message.error(e.data.info)})):Object(l["gj"])({type:"明细",page:this.pageIndex3,page_size:this.pageSize3}).then((function(e){2e3==e.code?(t.datetime=e.data.datetime,t.dtlArr=e.data.data,t.pageTotal3=e.data.total):t.$message.error(e.data.info)})),this.$load.close()},toImg:function(){var t=this;o()(this.$refs.print,{backgroundColor:"white",useCORS:!0,windowHeight:document.body.scrollHeight}).then((function(e){var a=e.toDataURL();t.img=a,t.download()}))},download:function(){var t=this.img;this.downloadFile("库存表（"+this.table+"）.png",t)},downloadFile:function(t,e){var a=document.createElement("a"),n=this.base64ToBlob(e),i=document.createEvent("HTMLEvents");i.initEvent("click",!0,!0),a.download=t,a.href=URL.createObjectURL(n),a.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}))},base64ToBlob:function(t){for(var e=t.split(";base64,"),a=e[0].split(":")[1],n=window.atob(e[1]),i=n.length,l=new Uint8Array(i),s=0;s<i;++s)l[s]=n.charCodeAt(s);return new Blob([l],{type:a})},printContext:function(){this.$print(this.$refs.print)},showInput:function(){null==this.bonusData.table&&(this.bonusData.table=[]),null==this.bonusData.condition&&(this.bonusData.condition=[]),null==this.bonusData.parameter&&(this.bonusData.parameter=[]);var t="";this.bonusData.table.push(t),this.bonusData.condition.push(t),this.bonusData.parameter.push(t)},selectOne1:function(t){if("明细"==this.table)for(var e=0;e<this.allArr.dtl_pull[0].field.length;e++)this.allArr.dtl_pull[0].field[e].name_no==this.bonusData.table[t]&&(this.tableNo=e);else for(e=0;e<this.allArr.screen_pull[0].field.length;e++)this.allArr.screen_pull[0].field[e].name_no==this.bonusData.table[t]&&(this.tableNo=e);this.arrs[t]=this.tableNo},selectOne_vague:function(t){"like"==this.bonusData.condition[0]?this.vague=!1:this.vague=!0},deleteRow:function(t,e){for(var a=0;a<e.table.length;a++)console.log(e.table[a],this.bonusData.table[t]),e.table[a]==this.bonusData.table[t]&&(e.table.splice(a,1),e.condition.splice(a,1),e.parameter.splice(a,1))},saveOk:function(){var t=this;this.dtlArr=[],this.pageTotal1=0,this.pageTotal2=0,this.pageTotal3=0;for(var e=[],a=0;a<this.bonusData.table.length&&this.bonusData.condition.length&&this.bonusData.parameter.length;a++)e[a]={},e[a].field=this.bonusData.table[a],e[a].condition=this.bonusData.condition[a],e[a].parameter=this.bonusData.parameter[a];this.arrBigs=e,this.pageIndex=1,this.pageSize=30,Object(l["gj"])({type:this.table,data:e,page:this.pageIndex,page_size:this.pageSize}).then((function(e){2e3==e.code?(t.outData.isshow=!1,"品类"==t.table?(t.kindArr=e.data.data,t.kindTotal=e.data.data_total,t.kindData=e.data.datetime,t.pageTotal1=e.data.total):"柜台"==t.table?(t.counterList=e.data.data,t.pageTotal2=e.data.total):(t.dtlArr=e.data.data,t.pageTotal3=e.data.total),console.log(e.data)):(t.outData.isshow=!1,t.$message.error(e.data.info))}))},getPermission:function(){var t=this;Object(l["xb"])({id:"45"}).then((function(e){2e3==e.code?(console.log(e.data),t.perData=e.data):t.$message.error(e.msg)}))},getSystem:function(){var t=this;Object(l["gg"])({}).then((function(e){2e3==e.code?t.systemSet=e.data:t.$message.error(e.data.info)}))},handlePageChange:function(t){this.pageIndex=t,this.selectTable()},pageSizeChange:function(t){this.pageSize=t,this.selectTable()},handlePageChange2:function(t){this.pageIndex2=t,this.selectTable()},pageSizeChange2:function(t){this.pageSize2=t,this.selectTable()},handlePageChange3:function(t){this.pageIndex3=t,this.selectTable()},pageSizeChange3:function(t){this.pageSize3=t,this.selectTable()},outExcel:function(){var t=this.username,e=this.arrBigs,a=JSON.stringify(e);'""'==a&&(a=[]),window.open("".concat(this.$baseURL,"stock_export?data=").concat(a,"&login_staff=").concat(t,"&type=").concat(this.table),"_blank")}}},c=r,d=(a("c09d"),a("2877")),u=Object(d["a"])(c,n,i,!1,null,"63165bca",null);e["default"]=u.exports},c09d:function(t,e,a){"use strict";var n=a("dc86"),i=a.n(n);i.a},dc86:function(t,e,a){}}]);
//# sourceMappingURL=chunk-1c892234.e008620c.js.map